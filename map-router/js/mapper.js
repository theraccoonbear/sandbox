var MapController = function() {
	this.APIKey = 'AIzaSyByuznobv2fB1wy4eWIZPWQxZWBiv_IrtE';
	this.waypoint = [
		[43.0377032,-89.5040274,0.0],
		[43.0376051,-89.5042446,0.0],
		[43.0375306,-89.5044887,0.0],
		[43.0374953,-89.5048374,0.0],
		[43.0374816,-89.5051593,0.0],
		[43.0375091,-89.5054275,0.0],
		[43.0377286,-89.505693,0.0],
		[43.0380619,-89.5059854,0.0],
		[43.0381717,-89.5061892,0.0],
		[43.0381482,-89.5063609,0.0],
		[43.0380188,-89.5065433,0.0],
		[43.0378188,-89.5068061,0.0],
		[43.0376659,-89.5070368,0.0],
		[43.0374385,-89.5074177,0.0],
		[43.0373091,-89.5076644,0.0],
		[43.0372072,-89.5079166,0.0],
		[43.0371248,-89.5081472,0.0],
		[43.0370425,-89.5084637,0.0],
		[43.0369641,-89.5087105,0.0],
		[43.0368621,-89.5090967,0.0],
		[43.0367798,-89.5092952,0.0],
		[43.0367366,-89.5095098,0.0],
		[43.0367014,-89.5098317,0.0],
		[43.0367014,-89.5101696,0.0],
		[43.036717,-89.5104003,0.0],
		[43.0367366,-89.5106202,0.0],
		[43.0367955,-89.5107919,0.0],
		[43.0369445,-89.5109367,0.0],
		[43.0371601,-89.5109636,0.0],
		[43.0373875,-89.5109153,0.0],
		[43.0376306,-89.5108134,0.0],
		[43.0379051,-89.5107329,0.0],
		[43.0380345,-89.5106041,0.0],
		[43.0382227,-89.5104164,0.0],
		[43.0383873,-89.5102018,0.0],
		[43.0385128,-89.5099872,0.0],
		[43.0385834,-89.50966,0.0],
		[43.0386383,-89.5094883,0.0],
		[43.0387363,-89.5094669,0.0],
		[43.0388422,-89.5096546,0.0],
		[43.038899,-89.5098102,0.0],
		[43.0389206,-89.5099953,0.0],
		[43.0389382,-89.5101589,0.0],
		[43.0389382,-89.5102903,0.0],
		[43.0389441,-89.5105693,0.0],
		[43.0389421,-89.5107543,0.0],
		[43.0389559,-89.511205,0.0],
		[43.0389539,-89.5114303,0.0],
		[43.0389598,-89.5117173,0.0],
		[43.0389539,-89.5120311,0.0],
		[43.0389539,-89.5123824,0.0],
		[43.0389147,-89.5126534,0.0],
		[43.0388206,-89.5128277,0.0],
		[43.0386657,-89.5129538,0.0],
		[43.0385755,-89.5129913,0.0],
		[43.0384226,-89.5130771,0.0],
		[43.0380149,-89.5131093,0.0],
		[43.0377012,-89.5131254,0.0],
		[43.0375169,-89.5131522,0.0],
		[43.0373444,-89.5130986,0.0],
		[43.0371013,-89.5131147,0.0],
		[43.0368111,-89.5132488,0.0],
		[43.0366622,-89.513399,0.0],
		[43.0367445,-89.5135438,0.0],
		[43.036917,-89.5135868,0.0],
		[43.0371993,-89.5134956,0.0],
		[43.0373365,-89.5135331,0.0],
		[43.0374777,-89.5135814,0.0],
		[43.0377051,-89.5134848,0.0],
		[43.0379482,-89.5134795,0.0],
		[43.0381286,-89.5134312,0.0],
		[43.0383913,-89.5134044,0.0],
		[43.0386579,-89.5132542,0.0],
		[43.0388069,-89.5130718,0.0],
		[43.0390656,-89.5128411,0.0],
		[43.0392264,-89.5128089,0.0],
		[43.0394224,-89.5128304,0.0],
		[43.0396773,-89.5127499,0.0],
		[43.0398459,-89.5126426,0.0],
		[43.0400105,-89.5125514,0.0],
		[43.0401674,-89.5124012,0.0],
		[43.040285,-89.5122027,0.0],
		[43.040383,-89.5118916,0.0],
		[43.0403713,-89.5116234,0.0],
		[43.0403399,-89.5112801,0.0],
		[43.0402693,-89.5108616,0.0],
		[43.0402576,-89.5106363,0.0],
		[43.0403203,-89.510293,0.0],
		[43.0403556,-89.509939,0.0],
		[43.0404261,-89.5094454,0.0],
		[43.0404928,-89.5091718,0.0],
		[43.0406065,-89.5090002,0.0],
		[43.0407398,-89.5089304,0.0],
		[43.0409084,-89.5089465,0.0],
		[43.0410652,-89.5091182,0.0],
		[43.0412064,-89.5093864,0.0],
		[43.0413122,-89.5096225,0.0],
		[43.0414338,-89.5099926,0.0],
		[43.0415749,-89.5103306,0.0],
		[43.0416455,-89.5105666,0.0],
		[43.041716,-89.5109206,0.0],
		[43.041767,-89.511162,0.0],
		[43.0417239,-89.5114517,0.0],
		[43.0416572,-89.5116341,0.0],
		[43.0416023,-89.5118165,0.0],
		[43.0415122,-89.5120043,0.0],
		[43.0413789,-89.5122135,0.0],
		[43.0412338,-89.5124227,0.0],
		[43.0410691,-89.5125622,0.0],
		[43.0410495,-89.5126802,0.0],
		[43.0411789,-89.5127928,0.0],
		[43.0414063,-89.5127338,0.0],
		[43.0415318,-89.5125192,0.0],
		[43.0416494,-89.5122886,0.0],
		[43.0418141,-89.5119292,0.0],
		[43.0418885,-89.5116985,0.0],
		[43.0420493,-89.5114356,0.0],
		[43.0421199,-89.5110494,0.0],
		[43.0421355,-89.5107329,0.0],
		[43.0420807,-89.5104486,0.0],
		[43.0419317,-89.5102072,0.0],
		[43.0417788,-89.5100087,0.0],
		[43.0416298,-89.5098156,0.0],
		[43.0415004,-89.5095903,0.0],
		[43.0414063,-89.5093918,0.0],
		[43.0413122,-89.5090806,0.0],
		[43.0412573,-89.5088714,0.0],
		[43.0411201,-89.5086569,0.0],
		[43.0410025,-89.5085764,0.0],
		[43.0408849,-89.5086032,0.0],
		[43.0407516,-89.5087212,0.0],
		[43.0406104,-89.5088178,0.0],
		[43.0404418,-89.5087588,0.0],
		[43.0403242,-89.5084691,0.0],
		[43.0401674,-89.5082331,0.0],
		[43.0400811,-89.5080292,0.0],
		[43.0399949,-89.507702,0.0],
		[43.0399321,-89.5074016,0.0],
		[43.0399047,-89.5070958,0.0],
		[43.0398616,-89.5067257,0.0],
		[43.0398733,-89.5065379,0.0],
		[43.0397518,-89.5061892,0.0],
		[43.0396577,-89.5059425,0.0],
		[43.039446,-89.5057601,0.0],
		[43.0392617,-89.5056045,0.0],
		[43.0391205,-89.5055455,0.0],
		[43.0390656,-89.5056099,0.0],
		[43.0390931,-89.505685,0.0],
		[43.039246,-89.5058298,0.0],
		[43.0394499,-89.5060337,0.0],
		[43.0396381,-89.506216,0.0],
		[43.0397204,-89.5065004,0.0],
		[43.0397675,-89.5067364,0.0],
		[43.0397753,-89.5071012,0.0],
		[43.0398341,-89.5073158,0.0],
		[43.0398772,-89.5076108,0.0],
		[43.0399596,-89.5079005,0.0],
		[43.0400419,-89.5081311,0.0],
		[43.0401478,-89.5083725,0.0],
		[43.0402497,-89.5084852,0.0],
		[43.0403281,-89.5086354,0.0],
		[43.0403595,-89.5087963,0.0],
		[43.0404065,-89.5090806,0.0],
		[43.0403673,-89.509322,0.0],
		[43.0403242,-89.5096117,0.0],
		[43.040285,-89.5099014,0.0],
		[43.0402615,-89.5101106,0.0],
		[43.0402223,-89.5104486,0.0],
		[43.0401909,-89.5106417,0.0],
		[43.0401948,-89.510926,0.0],
		[43.0402458,-89.5111996,0.0],
		[43.0402811,-89.5115107,0.0],
		[43.0402419,-89.5117521,0.0],
		[43.0401948,-89.5118916,0.0],
		[43.0400341,-89.5120686,0.0],
		[43.039842,-89.5122296,0.0],
		[43.0397047,-89.5123583,0.0],
		[43.0395714,-89.5124549,0.0],
		[43.039395,-89.5126104,0.0],
		[43.0392107,-89.5126534,0.0],
		[43.0391127,-89.5126051,0.0],
		[43.0390264,-89.5124012,0.0],
		[43.0390578,-89.5119345,0.0],
		[43.0390617,-89.5116019,0.0],
		[43.0390813,-89.5113122,0.0],
		[43.0391049,-89.5109475,0.0],
		[43.0391205,-89.5106792,0.0],
		[43.0391401,-89.510293,0.0],
		[43.0390696,-89.5100677,0.0],
		[43.0389402,-89.5098907,0.0],
		[43.0389088,-89.5097136,0.0],
		[43.0388422,-89.5095044,0.0],
		[43.0387363,-89.5092845,0.0],
		[43.0385795,-89.509027,0.0],
		[43.0384697,-89.5087695,0.0],
		[43.0383834,-89.5085549,0.0],
		[43.038305,-89.508276,0.0],
		[43.0382109,-89.5079809,0.0],
		[43.0381521,-89.5077074,0.0],
		[43.0380345,-89.5073909,0.0],
		[43.0378972,-89.5070636,0.0],
		[43.0378423,-89.5069188,0.0],
		[43.0378659,-89.5067847,0.0],
		[43.0379355,-89.5066921,0.0],
		[43.0380374,-89.5065473,0.0],
		[43.0381609,-89.5063716,0.0],
		[43.0381854,-89.5061785,0.0],
		[43.0381393,-89.5060712,0.0],
		[43.0380688,-89.5059679,0.0],
		[43.0379394,-89.5058526,0.0],
		[43.0377884,-89.5057145,0.0],
		[43.0376943,-89.5056193,0.0],
		[43.0376002,-89.5055093,0.0],
		[43.0375414,-89.5054409,0.0],
		[43.037512,-89.5053644,0.0],
		[43.0375051,-89.5052411,0.0],
		[43.0374993,-89.5050694,0.0],
		[43.0375051,-89.5049179,0.0],
		[43.0375149,-89.5047636,0.0],
		[43.0375297,-89.5046175,0.0],
		[43.0375483,-89.5044994,0.0],
		[43.0375728,-89.504419,0.0],
		[43.0376022,-89.5043117,0.0],
		[43.0376296,-89.5042285,0.0],
		[43.0376708,-89.5041266,0.0],
		[43.03771,-89.5040461,0.0]
	];
};

MapController.prototype.loadKML = function(url, cb) {
	
};
      function initialize() {
        var mapOptions = {
          zoom: 16,
          center: new google.maps.LatLng(arr[0][0], arr[0][1]),
          mapTypeId: google.maps.MapTypeId.SATELLITE
        };
        var map = new google.maps.Map(document.getElementById('map_canvas'),
            mapOptions);
       var line=new google.maps.Polyline(
              {
                map:map,
                strokeColor: '#FF0000',
          			strokeOpacity: 1.0,
          			strokeWeight: 2,
                icons: [{
                          icon: {
                                  path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
                                  strokeColor:'#ff0000',
                                  strokeWeight: 2,
                                  fillColor:'#ff0000',
                                  fillOpacity:1
                                },
                          repeat:'50px',
                          path:[]
                       }]
                 });
          
          //simulate incoming new positions every 2 seconds
          timer=setInterval(function(){
              var item=arr.shift();
              if(!arr.length){clearInterval(timer);}
              var path=line.getPath().getArray(),
                  latLng=new google.maps.LatLng(item[0],item[1]);
                  path.push(latLng);
                  line.setPath(path);
              		//map.panTo(latLng);
                  //new google.maps.Marker({map:map,position:latLng});
          },150);
      }

      google.maps.event.addDomListener(window, 'load', initialize);